import{j as e,r as d,c as T}from"./client-Cgxip4d8.js";import{a as m}from"./axios-BimPEqV4.js";const y=t=>e.jsxs("form",{onSubmit:t.addName,children:[e.jsxs("div",{children:["Name:",e.jsx("input",{name:"name",value:t.newName})]}),e.jsxs("div",{children:["Number:",e.jsx("input",{name:"number",value:t.newNumber})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",children:"Add"})})]}),C=t=>e.jsxs("div",{children:["filter shown with",e.jsx("input",{value:t.filters,onChange:t.handleFilterChange})]}),h="http://localhost:3001/persons",P=()=>{const t=m.get(h),n={id:1e4,name:"This person is not saved to server",number:""};return t.then(r=>r.data.concat(n))},A=t=>m.post(h,t).then(r=>r.data),k=(t,n)=>m.put(`${h}/${t}`,n).then(x=>x.data),q=t=>m.delete(`${h}/${t}`).then(r=>r.data),l={getAll:P,create:A,update:k,deleteItem:q},S=({person:t,onDelete:n})=>e.jsxs("li",{children:[e.jsxs("span",{children:[t.name," ",t.number]})," ",e.jsx("button",{onClick:()=>{window.confirm("Do you want to delete "+t.name+"?")&&l.deleteItem(t.id).then(()=>n()).catch(r=>{n(r)})},children:"Delete"})]}),w=({type:t="success",children:n})=>e.jsx("div",{className:`notification ${t}`,children:n}),E=()=>{const[t,n]=d.useState([]),[r,x]=d.useState(""),[f,o]=d.useState(""),[g,i]=d.useState("");d.useEffect(()=>{l.getAll().then(s=>{n(s)})},[]);const p=s=>{s.preventDefault();const a=s.target.elements.name.value,j=s.target.elements.number.value,b={name:a,number:j},u=t.find(c=>c.name===a);u?window.confirm(u.name+" is already added to phonebook, replace the old number with a new one?")&&l.update(u.id,b).then(c=>{n(t.map(v=>v.id!==u.id?v:c)),s.target.reset(),o(`Added ${a}`),setTimeout(()=>{o("")},5e3)}).catch(()=>{i(`Can not update ${a}`),setTimeout(()=>{i("")},5e3)}):l.create(b).then(c=>{n(t.concat(c)),s.target.reset(),o(`Added ${a}`),setTimeout(()=>{o("")},5e3)}).catch(()=>{i(`Can not create ${a}`),setTimeout(()=>{i("")},5e3)})},N=t.filter(s=>s.name.toLowerCase().includes(r.toLowerCase())),$=s=>{x(s.target.value)};return e.jsxs("div",{children:[e.jsx("h2",{children:"Phonebook"}),f?e.jsx(w,{type:"success",children:f}):null,g?e.jsx(w,{type:"error",children:g}):null,e.jsx(C,{filters:r,handleFilterChange:$}),e.jsx("h3",{children:"Add a new"}),e.jsx(y,{addName:p}),e.jsx("h2",{children:"Numbers"}),e.jsx("ul",{children:N.map(s=>e.jsx(S,{person:s,onDelete:(a="")=>{a?(i(`Can not delete ${s.name}`),setTimeout(()=>{i("")},5e3)):(o(`Deleted ${s.name}`),setTimeout(()=>{o("")},5e3),l.getAll().then(j=>{n(j)}))}},s.id))})]})},F=()=>e.jsxs("main",{children:[e.jsx("h1",{children:"Osa 2e Tyylien lisääminen React-sovellukseen"}),e.jsx("div",{className:"theory"}),e.jsx("h2",{children:"Tehtävät 2.16.-2.17."}),e.jsx("div",{className:"task",children:e.jsx(E,{})}),e.jsx("h2",{children:"Tehtävät 2.18.-2.20."}),e.jsx("div",{className:"task"})]});T.createRoot(document.getElementById("root")).render(e.jsx(F,{}));
