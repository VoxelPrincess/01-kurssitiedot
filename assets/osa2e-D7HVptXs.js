import{j as e,r as i,c as N}from"./client-Cgxip4d8.js";import{a as m}from"./axios-BimPEqV4.js";const T=t=>e.jsxs("form",{onSubmit:t.addName,children:[e.jsxs("div",{children:["Name:",e.jsx("input",{name:"name",value:t.newName})]}),e.jsxs("div",{children:["Number:",e.jsx("input",{name:"number",value:t.newNumber})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",children:"Add"})})]}),A=t=>e.jsxs("div",{children:["filter shown with",e.jsx("input",{value:t.filters,onChange:t.handleFilterChange})]}),f="http://localhost:3001/persons",E=()=>m.get(f).then(s=>s.data),U=t=>m.post(f,t).then(n=>n.data),k=(t,s)=>m.put(`${f}/${t}`,s).then(l=>l.data),q=t=>m.delete(`${f}/${t}`).then(n=>n.data),j={getAll:E,create:U,update:k,deleteItem:q},y=({person:t,onDelete:s})=>e.jsxs("li",{children:[e.jsxs("span",{children:[t.name," ",t.number]})," ",e.jsx("button",{onClick:()=>{window.confirm("Do you want to delete "+t.name+"?")&&j.deleteItem(t.id).then(()=>s()).catch(n=>{s(n)})},children:"Delete"})]}),b=({type:t="success",children:s})=>e.jsx("div",{className:`notification ${t}`,children:s}),P=()=>{const[t,s]=i.useState([]),[n,l]=i.useState(""),[c,a]=i.useState(""),[r,d]=i.useState("");i.useEffect(()=>{j.getAll().then(o=>{s(o)})},[]);const p=o=>{o.preventDefault();const h=o.target.elements.name.value,w=o.target.elements.number.value,C={name:h,number:w},g=t.find(x=>x.name===h);g?window.confirm(g.name+" is already added to phonebook, replace the old number with a new one?")&&j.update(g.id,C).then(x=>{s(t.map(v=>v.id!==g.id?v:x)),o.target.reset(),a(`Added ${h}`),setTimeout(()=>{a("")},5e3)}).catch(()=>{d(`Can not update ${h}`),setTimeout(()=>{d("")},5e3)}):j.create(C).then(x=>{s(t.concat(x)),o.target.reset(),a(`Added ${h}`),setTimeout(()=>{a("")},5e3)}).catch(()=>{d(`Can not create ${h}`),setTimeout(()=>{d("")},5e3)})},u=t.filter(o=>o.name.toLowerCase().includes(n.toLowerCase())),$=o=>{l(o.target.value)};return e.jsxs("div",{children:[e.jsx("h2",{children:"Phonebook"}),c?e.jsx(b,{type:"success",children:c}):null,r?e.jsx(b,{type:"error",children:r}):null,e.jsx(A,{filters:n,handleFilterChange:$}),e.jsx("h3",{children:"Add a new"}),e.jsx(T,{addName:p}),e.jsx("h2",{children:"Numbers"}),e.jsx("ul",{children:u.map(o=>e.jsx(y,{person:o,onDelete:(h="")=>{h?(d(`Can not delete ${o.name}`),setTimeout(()=>{d("")},5e3)):(a(`Deleted ${o.name}`),setTimeout(()=>{a("")},5e3),j.getAll().then(w=>{s(w)}))}},o.id))})]})},F="https://studies.cs.helsinki.fi/restcountries/api/all",D=async()=>(await m.get(F)).data,W=({newSearch:t,handleSearchChange:s})=>e.jsxs("form",{children:["find countries",e.jsx("input",{value:t,onChange:s}),e.jsx("br",{})]}),M="257204f6da7b11d0dfc3fd9581642efe",I=t=>m.get(`https://api.openweathermap.org/data/2.5/weather?q=${t}&appid=${M}`).then(s=>s.data),R=({capital:t})=>{const[s,n]=i.useState(null),[l,c]=i.useState(null),[a,r]=i.useState(null),[d,p]=i.useState(null);return i.useEffect(()=>{I(t).then(u=>{n((u.main.temp-273.15).toFixed(1)),c(`https://openweathermap.org/img/wn/${u.weather[0].icon}.png`),r(u.weather[0].description.charAt(0).toUpperCase()+u.weather[0].description.slice(1)),p(u.wind.speed)}).catch(u=>{console.log("Error fetching data:",u)})},[t]),e.jsxs("div",{children:[e.jsxs("h3",{children:["Current Weather in ",t]}),e.jsxs("p",{children:["Temperature: ",s,"°C"]}),e.jsx("img",{src:l,alt:"weather icon"}),e.jsx("p",{children:a}),e.jsxs("p",{children:["wind ",d," m/s"]})]})},S=({name:t,capital:s,population:n,languages:l,flagUrl:c})=>e.jsxs("div",{children:[e.jsx("h1",{children:t}),e.jsxs("p",{children:["capital ",s]}),e.jsxs("p",{children:["population ",n]}),e.jsx("h3",{children:"languages"}),e.jsx("ul",{children:Object.values(l).map(a=>e.jsx("li",{children:a},a))}),e.jsx("img",{src:c,alt:"No flag found",height:"250",width:"350"}),e.jsx(R,{capital:s})]}),L=({name:t,country:s,show:n})=>e.jsxs("li",{children:[t,e.jsx("button",{value:s.name.common,onClick:n,children:"Show"})]},t),O=({countries:t,newSearch:s})=>{const[n,l]=i.useState(),c=r=>{const d=t.filter(p=>p.name.common.includes(r.target.value));l(d[0])};i.useEffect(()=>{l(void 0)},[s]);const a=t.filter(r=>r.name.common.toUpperCase().includes(s.toUpperCase()));return a.length>=10?e.jsx("p",{children:"Too many matches, specify another filter"}):n!==void 0?e.jsx(S,{name:n.name.common,capital:n.capital[0],population:n.population,languages:n.languages,flagUrl:n.flags.png},n.name.common):a.length>1?e.jsx("ul",{children:t.filter(r=>r.name.common.toUpperCase().includes(s.toUpperCase())).map(r=>e.jsx(L,{name:r.name.common,country:r,show:c},r.name.common))}):e.jsx("ul",{children:t.filter(r=>r.name.common.toUpperCase().includes(s.toUpperCase())).map(r=>e.jsx(S,{name:r.name.common,capital:r.capital,population:r.population,languages:r.languages,flagUrl:r.flag},r.name.common))})},B=()=>{const[t,s]=i.useState(""),[n,l]=i.useState([]),c=a=>{s(a.target.value)};return i.useEffect(()=>{D().then(a=>l(a))},[]),e.jsxs("div",{children:[e.jsx(W,{newSearch:t,handleSearchChange:c}),e.jsx(O,{countries:n,newSearch:t})]})},K=()=>e.jsxs("main",{children:[e.jsx("h1",{children:"Osa 2e Tyylien lisääminen React-sovellukseen"}),e.jsx("h2",{children:"Tehtävät 2.16.-2.17."}),e.jsx("div",{className:"task",children:e.jsx(P,{})}),e.jsx("h2",{children:"Tehtävät 2.18.-2.20."}),e.jsx("div",{className:"task",children:e.jsx(B,{})})]});N.createRoot(document.getElementById("root")).render(e.jsx(K,{}));
